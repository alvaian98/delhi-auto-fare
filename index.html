<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Delhi Auto Fare Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f4f4f4;
    }

    .container {
      max-width: 450px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input[type="number"] {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-top: 15px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    .result {
      margin-top: 15px;
      padding: 15px;
      background-color: #e9f7ef;
      border-left: 5px solid #28a745;
      border-radius: 6px;
      font-size: 16px;
      white-space: pre-line;
    }

    .message {
      font-weight: bold;
      margin-top: 10px;
    }

    .more {
      color: red;
    }

    .less {
      color: blue;
    }

    .exact {
      color: green;
    }

    #resetBtn {
      background-color: #dc3545;
    }

    #resetBtn:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Delhi Auto Fare Calculator</h2>

    <label for="distance">Enter distance (kms):</label>
    <input type="number" id="distance" step="0.1" placeholder="Enter distance (kms)" />

    <label for="waiting">Enter waiting time (minutes):</label>
    <input type="number" id="waiting" step="1" min="0" value="0" placeholder="Enter waiting time (minutes)" />

    <button id="calcFareBtn">Calculate Fare</button>

    <div id="fareResult" class="result" style="display:none;"></div>

    <label for="charged" style="margin-top:30px;">Enter amount charged (Rs):</label>
    <input type="number" id="charged" step="0.1" placeholder="Enter amount charged (Rs)" />
    <button id="calcSavedBtn">Calculate Amount Saved</button>

    <div id="savedResult" class="result" style="display:none;">
      <div id="savedOutput"></div>
      <div id="savedMessage" class="message"></div>
    </div>

    <!-- ✅ Reset Button -->
    <button id="resetBtn" style="margin-top: 25px;">Reset</button>
  </div>

  <script>
    let currentFare = null; // To store fare after first calculation
    let baseFareWithoutWaitingOrNight = null;

    function isNightTime() {
      const now = new Date();
      const hour = now.getHours();
      // Night: 11 PM (23) to 5 AM (5)
      return (hour >= 23 || hour < 5);
    }

    function calculateFareForDistance(distance) {
      const minDistance = 1.5;
      if (distance < minDistance) {
        return 30; // Minimum fare for 1.5 km
      }
      return 30 + 11 * (distance - minDistance);
    }

    document.getElementById("calcFareBtn").addEventListener("click", () => {
      const distanceInput = document.getElementById("distance");
      const waitingInput = document.getElementById("waiting");
      const fareResult = document.getElementById("fareResult");

      const distance = parseFloat(distanceInput.value);
      const waitingMinutes = parseFloat(waitingInput.value);

      if (isNaN(distance) || distance <= 0) {
        fareResult.style.display = "block";
        fareResult.style.backgroundColor = "#f8d7da";
        fareResult.style.borderLeftColor = "red";
        fareResult.textContent = "⚠️ Please enter a valid positive distance.";
        currentFare = null;
        baseFareWithoutWaitingOrNight = null;
        return;
      }

      if (isNaN(waitingMinutes) || waitingMinutes < 0) {
        fareResult.style.display = "block";
        fareResult.style.backgroundColor = "#f8d7da";
        fareResult.style.borderLeftColor = "red";
        fareResult.textContent = "⚠️ Please enter a valid non-negative waiting time.";
        currentFare = null;
        baseFareWithoutWaitingOrNight = null;
        return;
      }

      baseFareWithoutWaitingOrNight = calculateFareForDistance(distance);
      const waitingCharge = waitingMinutes * 0.75;
      let fareBeforeNight = baseFareWithoutWaitingOrNight + waitingCharge;

      let nightCharge = 0;
      if (isNightTime()) {
        nightCharge = baseFareWithoutWaitingOrNight * 0.25;
      }

      currentFare = fareBeforeNight + nightCharge;

      let info = `Fare breakdown:\n` +
        `Distance Fare: Rs. ${baseFareWithoutWaitingOrNight.toFixed(2)}\n` +
        `Waiting Charge: Rs. ${waitingCharge.toFixed(2)}\n`;

      if (nightCharge > 0) {
        info += `Night Charge (25%): Rs. ${nightCharge.toFixed(2)}\n`;
      }

      info += `\nTotal Fare: Rs. ${currentFare.toFixed(2)}`;

      fareResult.style.display = "block";
      fareResult.style.backgroundColor = "#e9f7ef";
      fareResult.style.borderLeftColor = "#28a745";
      fareResult.textContent = info;
    });

    document.getElementById("calcSavedBtn").addEventListener("click", () => {
      const chargedInput = document.getElementById("charged");
      const savedResult = document.getElementById("savedResult");
      const savedOutput = document.getElementById("savedOutput");
      const savedMessage = document.getElementById("savedMessage");

      if (currentFare === null) {
        alert("Please calculate the fare first by entering the distance and waiting time, then clicking 'Calculate Fare'.");
        return;
      }

      const charged = parseFloat(chargedInput.value);
      if (isNaN(charged) || charged < 0) {
        savedResult.style.display = "block";
        savedResult.style.backgroundColor = "#f8d7da";
        savedResult.style.borderLeftColor = "red";
        savedOutput.textContent = "⚠️ Please enter a valid positive amount charged.";
        savedMessage.textContent = "";
        return;
      }

      const saved = charged - currentFare;

      let message = "";
      let msgClass = "";

      if (charged > currentFare) {
        message = "Oh My God! Zyada paisa le liya";
        msgClass = "more";
      } else if (charged < currentFare) {
        message = "Are Wah! Paisa kam mila";
        msgClass = "less";
      } else {
        message = "Kudos! Bilkul sahi paisa";
        msgClass = "exact";
      }

      savedResult.style.display = "block";
      savedResult.style.backgroundColor = "#e9f7ef";
      savedResult.style.borderLeftColor = "#28a745";

      savedOutput.innerHTML =
        `Amount Charged: Rs. ${charged.toFixed(2)}\n` +
        `Amount to be Saved: Rs. ${saved.toFixed(2)}`;

      savedMessage.textContent = message;
      savedMessage.className = `message ${msgClass}`;
    });

    // ✅ Reset Button Functionality
    document.getElementById("resetBtn").addEventListener("click", () => {
      document.getElementById("distance").value = "";
      document.getElementById("waiting").value = "0";
      document.getElementById("charged").value = "";

      document.getElementById("fareResult").style.display = "none";
      document.getElementById("savedResult").style.display = "none";

      currentFare = null;
      baseFareWithoutWaitingOrNight = null;
    });
  </script>
</body>
</html>
